<!doctype html>

<meta charset="utf-8" />
<meta name='google-site-verification' content='-jE-f4Gbpim9_feo74iK5zP_-tegU7xvV89-yqFy7ZI' />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="description" content="We want Bernie Sanders to be president. Now it's time to get up and make that happen. Volunteer work and grassroots events are being organized everyday in the US. It is time to do everything we can to bring him to the White House. Let's do this!">
<meta name="keywords" content="Bernie Sanders, FeelTheBern, Events, Bernie, Volunteer for Bernie, Phonebank for Bernie, Canvassing for Bernie, Bernie Rallies, Bernie Townhall #bernie2016, #feelthebern, #westandtogether">
<meta property="og:image" content="http://map.berniesanders.com/img/map-v-2.png" />
<meta property="og:url" content="http://map.berniesanders.com/" />
<meta property="og:title" content="Let's Organize and Help Bernie Win"/>
<meta property="og:description" content="We want Bernie Sanders to be president. Now it's time to get up and make that happen. Volunteer work and grassroots events are being organized everyday in the US. It is time to do everything we can to bring him to the White House. Let's do this!"/>
<link href='//api.tiles.mapbox.com/mapbox.js/v2.1.9/mapbox.css' rel='stylesheet' />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@BernieSanders">
<meta name="twitter:creator" content="@BernieSanders">
<meta name="twitter:title" content="Let's Organize and Help Bernie Win">
<meta name="twitter:description" content="We want Bernie Sanders to be president. Now it's time to get up and make that happen. Volunteer work and grassroots events are being organized everyday in the US. It is time to do everything we can to bring him to the White House. Let's do this!">
<meta name="twitter:image" content="http://map.berniesanders.com/img/map-v-2.png">

<link rel="stylesheet" type="text/css" href="./css/events-map.css">
<link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css?family=Merriweather:400,900,700' />
<link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css?family=Lato:100,900,700,400,300' />
<title>Let's Get to Work! Find Volunteer Work, Grassroots events, and official Rallies for Bernie Sanders.</title>
<!--[if lte IE 9]>
       <meta http-equiv="refresh" content="0; url=https://go.berniesanders.com/page/event/search_simple" />
     <![endif]-->
<body class='list-view initial-view'>
<section id='header'>
<div id="header" class='lato'>
  <a id="header-logo" href="http://www.berniesanders.com"><img src="//d2bq2yf31lju3q.cloudfront.net/img/logo.png" style="float: left; margin-left: 10px;"></a>

  <div class="main-title-area">
    <div style="margin-bottom: 4px;">
      <div id='spiel'>
        <strong>Join the Political Revolution!</strong><br>
        Find the nearest volunteer activity or meeting near you.

      </div>
    </div>
  </div>

  <nav>
    <ul id="nav">
      <li>
        <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://map.berniesanders.com/" data-text="I'm going to a volunteer event for Bernie Sanders! Find events near you!" data-related="BernieSanders" data-count="none">Tweet</a>&nbsp;&nbsp;<div class="fb-share-button" data-href="http://www.bernkit.com/" data-layout="button">
        <a href="javascript:fbShare('http://map.berniesanders.com/', 'Fb Share', 'Facebook share popup', 'http://www.bernkit.com/img/fb.png', 520, 350)"><img src='./img/icon/fb.png' /><span>Share</span></a></div>
        <!-- div class="fb-share-button" data-href="http://map.berniesanders.com/phonebank/" data-layout="button"></div -->
      </li>
      <li><a href="https://go.berniesanders.com/page/event/create" class="contribute contribute-big" target="_blank">Host an Event</a></li>
    </ul>
  </nav>
  <div style="clear: both"></div>
</div>
</section>
<section id='activity-area' class='clearfix'>
  <article id='events'>
    <div id='filters'>
      <div id='loading-icon' class='lato'>Loading...</div>
      <h3 id='switch-link'>
        <a href='javascript: void(null)' onclick='window.mapManager.toMapView()' id='to-map-view'>Show Map</a>
        <a href='javascript: void(null)' onclick='window.mapManager.toListView()' id='to-list-view'>Show List</a>
      </h3>
      <h4 class='lato title'>
        <span id='screen-title'>Filters</span>
        <span id='mobile-title'>Volunteer for Bernie</span>
      </h4>
      <form id='filter-form'>
        <table>
          <tr>
            <td>
              <h5 class='lato'>By Zipcode</h5>
              <input type='text' name='zipcode' maxlength='5' placeholder='ZIPCODE' onclick="this.select();" >
            </td>
            <td>
              <h5 class='lato'>Distance</h5>
              <select name='distance'>
                <option value='5'>5mi</option>
                <option value='20'>20mi</option>
                <option value='50' selected='selected'>50mi</option>
                <option value='100'>100mi</option>
              </select>
            </td>
            <td>
              <h5 class='lato'>Sort By</h5>
              <select name='sort'>
                <option value='time' selected='selected'>Time</option>
                <option value='distance'>Distance</option>
              </select>
              <input type='button' style='position: absolute; z-index: -1; opacity: 0;' id='hidden-button'/>
            </td>
          </tr>
        </table>
        <div id='filter-popup-area' class='lato'>
          <a href='javascript: void(null)' class='filter-button show-filter' onclick='$("#events").addClass("show-type-filter");'>
            Search by Event
          </a>
          <div id='filter-list-area'>
            <h5>Search by Event</h5>
            <div id='f-container'>
              <div id='filter-list-container'>
                <ul id='filter-list'></ul>
              </div>
              <div style='text-align: center'>
              <a href='javascript: void(null)' id='show-all' 
                 onclick='$("#filter-list").find("input[type=checkbox]").prop("checked", true).trigger("change");'>Show All</a> &bull; 
              <a href='javascript: void(null)'
                 onclick='$("#filter-list").find("input[type=checkbox]").prop("checked", false).trigger("change")'>Hide All</a>
              </div>
            </div>
            <p align='right'>
              <a href='javascript: void(null)' class='filter-button' 
                 onclick='$("#events").removeClass("show-type-filter");'>
                Hide Legend
              </a>
            </p>
          </div>
        </div>
      </form>
    </div>
    <div id='event-list-container'>
      <div id='hide-show-office' data-count="0">
        <a href='javascript: void(null)' class='contribute-big show-office' onclick='$("body").addClass("show-office")'>
          <span class='show-offices'>&#8882; Show Nearby Offices (<span id='campaign-off-count'></span>)</span>
        </a>
        <a href='javascript: void(null);' class='contribute-big hide-office' onclick='$("body").removeClass("show-office")'>
          <span class='hide-offices'>&#8883; Hide Offices</span>
        </a>
      </div>
      <ul id='event-list'><li class='mobile-only lato'>Please type in your <strong>zipcode</strong> to view nearby events.</li></ul>
      <footer>
        <div id='footer-area' >
          <h5>Bernie 2016</h5>
          <h5>PO BOx 905</h5>
          <h5>Burlington, VT 05402</h5>

          <div id='paid-for-bernie-box'>
            Paid for By Bernie 2016
          </div>
          <div id='footer-billionaire' style="margin-bottom: 30px;">
            <svg width="200" height="40">
                <image xlink:href="//d2bq2yf31lju3q.cloudfront.net/img/billionaires.svg" width="200" height="40"
                  x="0"
                />
            </svg>
          </div>

          <sub>&copy; Bernie 2016 | <a href='https://berniesanders.com/privacy-policy/'>Privacy Policy</a></sub>
        </div>

      </footer>
    </div>
  </article>
  <article id='map'>
    <div id='map-container'></div>
  </article>
</section>
<section id='campaign-offices'>
  <div class='viewport'>
    <h3 class='title'>Nearby Campaign Offices</h3>
    <a class='close-button lato' href='javascript: void(null);' onclick='$("body").removeClass("show-office")'>x</a>
    <div class='container'>
      <ul id='campaign-office-list'></ul>
    </div>
  </div>
</section>

<script src='//d2bq2yf31lju3q.cloudfront.net/js/d3.js' type='text/javascript'></script>
<script id='zipcodes-datadump' type='text/plain'></script>
<script src="//d2bq2yf31lju3q.cloudfront.net/js/jquery.js"></script>
<script src='//d2bq2yf31lju3q.cloudfront.net/js/deparam.min.js'></script>
<script src='//d2bq2yf31lju3q.cloudfront.net/js/mapbox.js'></script>
<!-- <script src='/js/leaflet-bouncer.js'></script> -->
<script src='./js/moment.min.js'></script>
<script src='./js/MapManager.js'></script>
<script type='text/javascript'>
window.eventTypeFilters = [
  {
    name: 'Campaign Office',
    id: 'campaign-office',
    onItem: "<img style='width: 14px; height: 14px;' src='//d2bq2yf31lju3q.cloudfront.net/img/icon/star.png' />",
    offItem: "<img style='width: 14px; height: 14px;' src='//d2bq2yf31lju3q.cloudfront.net/img/icon/star-gray.png' />"
  },
  {
    name: 'Bernie Event',
    id: 'bernie-event',
    onItem: "<span class='map-red-circle'></span>",
  },
  {
    name: 'Official Event',
    id: 'official-event',
  },
  {
    name: 'Phonebank',
    id: 'phonebank'
  },
  {
    name: 'Get Out The Vote',
    id: 'gotv'
  },
  {
    name: 'Canvassing',
    id: 'canvassing'
  },
  {
    name: 'Ballot Access',
    id: 'ballot-access'
  },
  {
    name: 'Carpool',
    id: 'carpool'
  },
  {
    name: 'Register Voters',
    id: 'register-voters'
  },
  {
    name: 'Barnstorm',
    id: 'barnstorm'
  },
  {
    name: 'Other',
    id: 'other'
  }
];
</script>
<script type='text/javascript'>
(function($, d3) {

$("#loading-icon").show();
$.ajax({
  url: '//d2bq2yf31lju3q.cloudfront.net/js/event-data.gz',
  dataType: 'script',
  cache: true, // otherwise will get fresh copy every page load
  success: function(data) {

    d3.csv('//d2bq2yf31lju3q.cloudfront.net/d/campaign-offices.csv',
      function(campaignOffices) {
        //Load zipcodes
        //d2bq2yf31lju3q.cloudfront.net
        d3.csv('//d2bq2yf31lju3q.cloudfront.net/d/us_postal_codes.gz',
         function(zipcodes) {
          //Clean data
          window.EVENT_DATA.results.forEach(function(d) {
            d.filters = [];
            //Set filter info
            switch(d.event_type_name) {
              case "Iowa Event":
              case "New Hampshire Event":
              case "South Carolina Event":
              case "Nevada Event":
              // case "Organizing Meeting": d.filters.push("official-event"); break;
              case "Rally":
              case "Town Meeting": d.filters.push("bernie-event"); break;
              case "Barnstorm": d.filters.push("barnstorm"); break;
              case "Get Out the Vote" : d.filters.push("gotv"); break;
              case "Gather ballot access signatures": d.filters.push("ballot-access"); break;
              case "Carpool to an early primary state": d.filters.push("carpool"); break;
              case "Canvass": d.filters.push("canvassing"); break;
              case "Phonebank event" : d.filters.push("phonebank"); break;
              case "Registering Voters": d.filters.push('register-voters'); break;
              default: d.filters.push('other'); break;
            }

            d.is_official = d.is_official == "1";
            if (d.is_official) { d.filters.push("official-event"); }
          });

          window.EVENT_DATA.results = window.EVENT_DATA.results.concat(
            campaignOffices.map(function(d){ 
              return {
                filters: ["campaign-office"],
                url: "https://maps.google.com?saddr=Current+Location&daddr=" + encodeURIComponent(d.address),
                longitude: d.lon,
                latitude: d.lat,
                name: d.name,
                location: d.address, 
                event_type_name: "Campaign Office",
                capacity: 0,
                id_obfuscated: d.address,
                phone: d.phone,
                is_official: false,
                image: d.photo,
                is_campaign_office: true
              };
            })
          );

          window.mapManager = MapManager(window.EVENT_DATA.results, campaignOffices, zipcodes);

          $(window).trigger("hashchange");
        });
      }
    );
  }, error: function(a,b,c) {
    console.log("ERROR", b,c);
  }
});


 /** initial loading before activating listeners...
  */

 var params = $.deparam(window.location.hash.substring(1));
  if (params.zipcode) { $("input[name='zipcode']").val(params.zipcode); }
  if (params.distance) { $("select[name='distance']").val(params.distance);}
  if (params.sort) { $("select[name='sort']").val(params.sort);}

/* Prepare filters */
$("#filter-list").append(
  window.eventTypeFilters.map(function(d) {
    return $("<li />")
              .append(
                $("<input type='checkbox' class='filter-type' />")
                    .attr('name', 'f[]')
                    .attr("value", d.id)
                    .attr("id", d.id)
                    .prop("checked", !params.f ? true : $.inArray(d.id, params.f) >= 0)
              )
              .append($("<label />").attr('for', d.id).append($("<span />").addClass('filter-on')
                        .append(d.onItem ? d.onItem : $("<span>").addClass('circle-button default-on')))
              .append($("<span />").addClass('filter-off')
                        .append(d.offItem ? d.offItem : $("<span>").addClass('circle-button default-off')))
                        .append($("<span>").text(d.name)));
  })
);
/***
 *  define events
 */
 //only numbers
 $("input[name='zipcode']").on('keyup keydown', function(e) {
  if (e.type == 'keydown' && (e.keyCode < 48 || e.keyCode > 57)
      && e.keyCode != 8 && !(e.keyCode >= 37 || e.keyCode <= 40)) {
    return false;
  }

  if (e.type == 'keyup' && $(this).val().length == 5) {
    if (! (e.keyCode >= 37 && e.keyCode <= 40) ) {
      $(this).closest("form#filter-form").submit();
      $("#hidden-button").focus();
    }
  }
 });

 /***
  *  onchange of select
  */
  $("select[name='distance'],select[name='sort']").on('change', function(e) {
    $(this).closest("form#filter-form").submit();
  });

  /** 
  * On filter type change
  */
  $(".filter-type").on('change', function(e) {
    $(this).closest("form#filter-form").submit();    
  })

 //On submit
 $("form#filter-form").on('submit', function(e) {
  var serial = $(this).serialize();
  window.location.hash = serial;
  e.preventDefault();
  return false;
 });

 $(window).on('hashchange', function(e) {
  var hash = window.location.hash;
  if (hash.length == 0 || hash.substring(1) == 0) { $("#loading-icon").hide(); return false; }

  var params = $.deparam(hash.substring(1));

  $("#loading-icon").show();
  setTimeout(function() {
    window.mapManager.filterByType(params.f);
    window.mapManager.filter(params.zipcode, params.distance, params.sort, params.f);
    $("#loading-icon").hide();
  }, 50);
  // $("#loading-icon").hide();
  if (params.zipcode.length == 5 && $("body").hasClass("initial-view")) {
    $("#events").removeClass("show-type-filter");
    $("body").removeClass("initial-view"); 
  }
 });

  var pre = $.deparam(window.location.hash.substring(1));
  if ($("body").hasClass("initial-view")) {
    if ($(window).width() >= 600 && (!pre.zipcode || pre && pre.zipcode.length != 5)) {
      $("#events").addClass("show-type-filter");
    }
  }


})(jQuery, d3);
</script>

<!-- SOCIAL -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58354050-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '1747464662152148',
      xfbml      : true,
      version    : 'v2.5'
    });
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
</body>
<script>
    function fbShare(url, title, descr, image, winWidth, winHeight) {
        var winTop = (screen.height / 2) - (winHeight / 2);
        var winLeft = (screen.width / 2) - (winWidth / 2);
        window.open('http://www.facebook.com/sharer.php?s=100&p[title]=' + title + '&p[summary]=' + descr + '&p[url]=' + url + '&p[images][0]=' + image, 'sharer', 'top=' + winTop + ',left=' + winLeft + ',toolbar=0,status=0,width=' + winWidth + ',height=' + winHeight);
    }
</script>
